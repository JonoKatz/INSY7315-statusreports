@model List<LeaseLogic.Models.PropertyModel>
@{
    ViewData["Title"] = "Manage Properties";
}

<div class="container mt-4" style="font-family: Arial, sans-serif;">
    <h2 style="color:#142943;">Property List</h2>

    <a asp-action="Add" class="btn text-white mb-3" style="background-color:#2572ad;">+ Add Property</a>

    <table class="table table-bordered shadow align-middle" style="font-family: Arial, sans-serif;">
        <thead style="background-color:#2572ad; color:#ffffff;">
            <tr class="text-center">
                <th>Image</th>
                <th>Property Name</th>
                <th>Price</th>
                <th>Location</th>
                <th>Status</th>
                <th style="width:220px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var property in Model)
            {
                <tr>
                    <td class="text-center" style="width: 100px;">
                        @if (property.Images != null && property.Images.Any())
                        {
                            var firstImageBase64 = Convert.ToBase64String(property.Images.First());
                            <img src="data:image/png;base64,@firstImageBase64"
                                 alt="Property Image"
                                 style="width:70px; height:70px; object-fit:cover; border-radius:8px;" />
                        }
                        else
                        {
                            <span style="color:#888;">No Image</span>
                        }
                    </td>
                    <td>@property.Name</td>
                    <td>@($"R{property.Price:N0}")</td>
                    <td>@property.Location</td>
                    <td>@property.Status</td>
                    <td class="text-center">
                        <a asp-action="View" asp-route-id="@property.Id"
                           class="btn btn-sm btn-outline-success view-btn">
                            View
                        </a>

                        <a asp-action="Edit" asp-route-id="@property.Id"
                           class="btn btn-sm btn-outline-primary edit-btn">
                            Edit
                        </a>

                        <form asp-action="Delete" asp-route-id="@property.Id" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-outline-danger"
                                    onclick="return confirm('Are you sure you want to delete this property?');">
                                Delete
                            </button>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
